{% extends "base.html" %} 
{% block title %}{{ student.full_name }} - Student Details - Namong SDA JHS{% endblock %} 

{% block content %}
<div class="space-y-8">
  <!-- Animated Background Header -->
  <div class="relative overflow-hidden rounded-2xl bg-gradient-to-r from-indigo-500 to-purple-600 shadow-2xl">
    <div class="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiPjxkZWZzPjxwYXR0ZXJuIGlkPSJwYXR0ZXJuIiB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHBhdHRlcm5Vbml0cz0idXNlclNwYWNlT25Vc2UiIHBhdHRlcm5UcmFuc2Zvcm09InJvdGF0ZSg0NSkiPjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0icmdiYSgyNTUsMjU1LDI1NSwwLjA1KSIvPjwvcGF0dGVybj48L2RlZnM+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0idXJsKCNwYXR0ZXJuKSIvPjwvc3ZnPg==')]"></div>
    
    <div class="relative p-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between">
        <div>
          <h1 class="text-4xl font-bold text-white">
            Student Profile
          </h1>
          <p class="mt-2 text-lg text-indigo-100">
            Complete information for {{ student.full_name }}
          </p>
        </div>
        <div class="mt-4 sm:mt-0 flex items-center space-x-3">
          <div class="flex items-center space-x-2 text-sm text-white/90">
            <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
            <span class="text-green-200">Active Student</span>
          </div>
          <span class="inline-flex items-center px-3 py-1 rounded-full text-xs font-medium bg-white/20 text-white backdrop-blur-sm">
            ID: {{ student.id }}
          </span>
        </div>
      </div>
    </div>
  </div>

  <!-- Student Overview Card -->
  <div class="relative">
    <!-- Floating decorative elements -->
    <div class="absolute -top-10 -left-10 w-20 h-20 bg-purple-400 rounded-full opacity-10 blur-xl"></div>
    <div class="absolute -bottom-5 -right-5 w-32 h-32 bg-indigo-400 rounded-full opacity-10 blur-xl"></div>
    
    <div class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-3xl border border-gray-200/70 dark:border-gray-700/50 shadow-2xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-xl hover:shadow-indigo-200/30 dark:hover:shadow-indigo-900/20">
      <div class="relative">
        <!-- Animated background gradient -->
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-50/30 via-purple-50/20 to-blue-50/10 dark:from-indigo-900/10 dark:via-purple-900/10 dark:to-blue-900/10 animate-gradient-x"></div>

        <div class="relative p-8">
          <div class="flex flex-col lg:flex-row lg:items-center lg:space-x-8">
            <!-- Student Photo with hover effect -->
            <div class="flex-shrink-0 mb-6 lg:mb-0 transform hover:scale-105 transition-transform duration-300">
              <div class="relative">
                {% if student.photo_path %}
                <img
                  src="{{ url_for('students.student_photo', filename=student.photo_path) }}"
                  alt="{{ student.full_name }}"
                  class="w-32 h-32 lg:w-40 lg:h-40 rounded-2xl object-cover border-4 border-white dark:border-gray-700 shadow-xl hover:shadow-2xl hover:border-indigo-200 transition-all duration-300"
                  onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,%3Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"160\" height=\"160\" viewBox=\"0 0 160 160\"%3E%3Crect width=\"160\" height=\"160\" fill=\"%23" + (student.gender == 'Male' ? '3b82f6' : 'ec4899') + "\"/%3E%3Ctext x=\"50%\" y=\"50%\" font-family=\"Arial\" font-size=\"60\" fill=\"white\" text-anchor=\"middle\" dominant-baseline=\"middle\"%3E{{ student.first_name[0] }}{{ student.surname[0] }}%3C/text%3E%3C/svg%3E'"
                />
                {% else %}
                <div
                  class="w-32 h-32 lg:w-40 lg:h-40 rounded-2xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shadow-xl hover:shadow-2xl transition-all duration-300"
                >
                  <span class="text-4xl lg:text-5xl font-bold">{{ student.first_name[0] }}{{ student.surname[0] }}</span>
                </div>
                {% endif %}

                <!-- Interactive Status Badge -->
                <div
                  class="absolute -bottom-2 -right-2 bg-green-500 rounded-full p-2 border-4 border-white dark:border-gray-900 shadow-lg cursor-pointer tooltip"
                  data-tooltip="Active since {{ student.admission_date.strftime('%b %Y') if student.admission_date else 'Unknown' }}"
                  onclick="toggleStatus()"
                >
                  <svg
                    class="h-4 w-4 text-white"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M5 13l4 4L19 7"
                    />
                  </svg>
                </div>
              </div>
            </div>

            <!-- Student Basic Info -->
            <div class="flex-1">
              <div class="mb-6">
                <h2 class="text-3xl font-bold text-gray-900 dark:text-white mb-2 flex items-center">
                  {{ student.full_name }}
                  <button onclick="copyToClipboard('{{ student.full_name }}')" class="ml-2 text-gray-400 hover:text-indigo-500 transition-colors duration-200">
                    <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"></path>
                    </svg>
                  </button>
                </h2>
                
                <div class="flex flex-wrap items-center gap-3 mb-4">
                  <span
                    class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800/70 transition-colors duration-200"
                  >
                    <svg
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                      />
                    </svg>
                    {{ student.classroom.name if student.classroom else 'Unassigned' }}
                  </span>

                  <span
                    class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium {% if student.gender == 'Male' %}bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200 hover:bg-blue-200 dark:hover:bg-blue-800/70{% else %}bg-pink-100 dark:bg-pink-900/50 text-pink-800 dark:text-pink-200 hover:bg-pink-200 dark:hover:bg-pink-800/70{% endif %} transition-colors duration-200"
                  >
                    <svg
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                      />
                    </svg>
                    {{ student.gender }}
                  </span>

                  <span
                    class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-emerald-100 dark:bg-emerald-900/50 text-emerald-800 dark:text-emerald-200 hover:bg-emerald-200 dark:hover:bg-emerald-800/70 transition-colors duration-200"
                  >
                    <svg
                      class="h-4 w-4 mr-1"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 0h6m-6 0l-2 2m8-2l2 2m-2-2v6a2 2 0 01-2 2H8a2 2 0 01-2-2v-6"
                      />
                    </svg>
                    Age: {{ student.age }}
                  </span>
                </div>
              </div>

              <!-- Quick Stats with hover effects -->
              <div class="grid grid-cols-2 lg:grid-cols-4 gap-4">
                <div
                  class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-4 text-center hover:bg-white/90 dark:hover:bg-gray-800/90 transition-all duration-300 hover:-translate-y-1 cursor-pointer"
                  onclick="copyToClipboard('{{ student.id }}')"
                >
                  <div
                    class="text-2xl font-bold text-indigo-600 dark:text-indigo-400"
                  >
                    {{ student.id }}
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Student ID
                    <span class="text-xs text-gray-400 ml-1">(click to copy)</span>
                  </div>
                </div>

                <div
                  class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-4 text-center hover:bg-white/90 dark:hover:bg-gray-800/90 transition-all duration-300 hover:-translate-y-1"
                >
                  <div
                    class="text-2xl font-bold text-emerald-600 dark:text-emerald-400"
                  >
                    {{ student.date_of_birth.strftime('%Y') }}
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Birth Year
                  </div>
                </div>

                <div
                  class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-4 text-center hover:bg-white/90 dark:hover:bg-gray-800/90 transition-all duration-300 hover:-translate-y-1"
                >
                  <div
                    class="text-2xl font-bold text-purple-600 dark:text-purple-400"
                  >
                    {% if student.learning_style %}{{ student.learning_style[:1] }}{% else %}N{% endif %}
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Learning Style
                  </div>
                </div>

                <div
                  class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-4 text-center hover:bg-white/90 dark:hover:bg-gray-800/90 transition-all duration-300 hover:-translate-y-1"
                >
                  <div
                    class="text-2xl font-bold text-amber-600 dark:text-amber-400"
                  >
                    {% if student.subjects %}{{ student.subjects|length }}{% else %}0{% endif %}
                  </div>
                  <div class="text-sm text-gray-600 dark:text-gray-400">
                    Subjects
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Detailed Information Grid -->
  <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-8">
    <!-- Personal Information -->
    <div
      class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-indigo-100/30 dark:hover:shadow-indigo-900/10"
    >
      <div class="p-8">
        <div class="flex items-center mb-6">
          <div
            class="p-3 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">
              Personal Information
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Basic student details
            </p>
          </div>
        </div>

        <div class="space-y-4">
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg group-hover:bg-blue-200 dark:group-hover:bg-blue-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-blue-600 dark:text-blue-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Full Name
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.full_name }}
              </div>
            </div>
          </div>

          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg group-hover:bg-purple-200 dark:group-hover:bg-purple-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-purple-600 dark:text-purple-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 7V3a2 2 0 012-2h4a2 2 0 012 2v4m-6 0h6m-6 0l-2 2m8-2l2 2m-2-2v6a2 2 0 01-2 2H8a2 2 0 01-2-2v-6"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Date of Birth
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.date_of_birth.strftime('%B %d, %Y') }}
                <span class="text-xs text-gray-400 ml-2">({{ student.age }} years old)</span>
              </div>
            </div>
          </div>

          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-emerald-100 dark:bg-emerald-900/50 rounded-lg group-hover:bg-emerald-200 dark:group-hover:bg-emerald-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-emerald-600 dark:text-emerald-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Hometown
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.hometown or 'Not specified' }}
              </div>
            </div>
          </div>

          {% if student.religion %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-amber-100 dark:bg-amber-900/50 rounded-lg group-hover:bg-amber-200 dark:group-hover:bg-amber-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-amber-600 dark:text-amber-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Religion
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.religion }}
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.height %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg group-hover:bg-blue-200 dark:group-hover:bg-blue-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-blue-600 dark:text-blue-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M7 11l5-5m0 0l5 5m-5-5v12"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Height
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.height }} cm
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.weight %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-indigo-100 dark:bg-indigo-900/50 rounded-lg group-hover:bg-indigo-200 dark:group-hover:bg-indigo-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-indigo-600 dark:text-indigo-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Weight
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.weight }} kg
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.admission_date %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-green-100 dark:bg-green-900/50 rounded-lg group-hover:bg-green-200 dark:group-hover:bg-green-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-green-600 dark:text-green-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Admission Date
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.admission_date.strftime('%B %d, %Y') }}
                <span class="text-xs text-gray-400 ml-2">
                  ({{ ((current_date - student.admission_date).days // 365) if student.admission_date else '0' }} years at school)
                </span>
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Guardian Information -->
    <div
      class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-emerald-100/30 dark:hover:shadow-emerald-900/10"
    >
      <div class="p-8">
        <div class="flex items-center mb-6">
          <div
            class="p-3 bg-gradient-to-br from-emerald-500 to-green-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">
              Guardian Information
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Family and emergency contacts
            </p>
          </div>
        </div>

        <div class="space-y-4">
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg group-hover:bg-blue-200 dark:group-hover:bg-blue-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-blue-600 dark:text-blue-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Father
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.father_name or 'Not specified' }}
                {% if student.father_contact %}
                <div class="text-xs text-gray-500 mt-1">
                  <svg class="inline h-3 w-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                  </svg>
                  {{ student.father_contact }}
                </div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-pink-100 dark:bg-pink-900/50 rounded-lg group-hover:bg-pink-200 dark:group-hover:bg-pink-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-pink-600 dark:text-pink-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Mother
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.mother_name or 'Not specified' }}
                {% if student.mother_contact %}
                <div class="text-xs text-gray-500 mt-1">
                  <svg class="inline h-3 w-3 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                  </svg>
                  {{ student.mother_contact }}
                </div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-emerald-100 dark:bg-emerald-900/50 rounded-lg group-hover:bg-emerald-200 dark:group-hover:bg-emerald-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-emerald-600 dark:text-emerald-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Primary Guardian
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.guardian_name or 'Not specified' }}
              </div>
            </div>
          </div>

          {% if student.guardian_contact %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-amber-100 dark:bg-amber-900/50 rounded-lg group-hover:bg-amber-200 dark:group-hover:bg-amber-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-amber-600 dark:text-amber-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Contact Number
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.guardian_contact }}
                <button onclick="callNumber('{{ student.guardian_contact }}')" class="ml-2 text-blue-500 hover:text-blue-700">
                  <svg class="h-4 w-4 inline" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                  </svg>
                </button>
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.guardian_address %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-indigo-100 dark:bg-indigo-900/50 rounded-lg group-hover:bg-indigo-200 dark:group-hover:bg-indigo-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-indigo-600 dark:text-indigo-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
                />
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Address
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.guardian_address }}
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Academic Information -->
    <div
      class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-amber-100/30 dark:hover:shadow-amber-900/10"
    >
      <div class="p-8">
        <div class="flex items-center mb-6">
          <div
            class="p-3 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">
              Academic Information
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Educational details and preferences
            </p>
          </div>
        </div>

        <div class="space-y-4">
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg group-hover:bg-blue-200 dark:group-hover:bg-blue-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-blue-600 dark:text-blue-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Current Class
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.classroom.name if student.classroom else 'Unassigned' }}
              </div>
            </div>
          </div>

          {% if student.admission_date %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-green-100 dark:bg-green-900/50 rounded-lg group-hover:bg-green-200 dark:group-hover:bg-green-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-green-600 dark:text-green-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Admission Date
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.admission_date.strftime('%B %d, %Y') }}
                <span class="text-xs text-gray-400 ml-2">
                  ({{ ((current_date - student.admission_date).days // 365) if student.admission_date else '0' }} years at school)
                </span>
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.learning_style %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg group-hover:bg-purple-200 dark:group-hover:bg-purple-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-purple-600 dark:text-purple-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Learning Style
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.learning_style }}
                <div class="mt-1">
                  <div class="w-full bg-gray-200 rounded-full h-1.5 dark:bg-gray-700">
                    <div class="bg-purple-600 h-1.5 rounded-full" style="width: {% if student.learning_style == 'Visual' %}75%{% elif student.learning_style == 'Auditory' %}60%{% else %}50%{% endif %}"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.medical_records %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-red-100 dark:bg-red-900/50 rounded-lg group-hover:bg-red-200 dark:group-hover:bg-red-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-red-600 dark:text-red-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Medical Records
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.medical_records|truncate(50) }}
                <button onclick="showMedicalDetails()" class="text-blue-500 text-xs ml-1 hover:underline">View details</button>
              </div>
            </div>
          </div>
          {% endif %}

          {% if student.notes %}
          <div class="flex items-start space-x-3 group">
            <div class="p-2 bg-yellow-100 dark:bg-yellow-900/50 rounded-lg group-hover:bg-yellow-200 dark:group-hover:bg-yellow-800/70 transition-colors duration-200">
              <svg
                class="h-4 w-4 text-yellow-600 dark:text-yellow-400"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
                />
              </svg>
            </div>
            <div class="flex-1">
              <div class="text-sm font-medium text-gray-900 dark:text-white">
                Special Notes
              </div>
              <div class="text-sm text-gray-600 dark:text-gray-400">
                {{ student.notes|truncate(50) }}
                <button onclick="showNotesDetails()" class="text-blue-500 text-xs ml-1 hover:underline">View notes</button>
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  <!-- Academic Performance Section -->
  <div
    class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-purple-100/30 dark:hover:shadow-purple-900/10"
  >
    <div class="p-8">
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center">
          <div
            class="p-3 bg-gradient-to-br from-purple-500 to-pink-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">
              Academic Performance
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Subject grades and performance tracking
            </p>
          </div>
        </div>

        <div class="flex space-x-3">
          <div class="relative group">
            <button
              onclick="saveGrades()"
              class="inline-flex items-center px-4 py-2 bg-gradient-to-r from-emerald-600 to-green-600 hover:from-emerald-700 hover:to-green-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200"
            >
              <svg
                class="h-4 w-4 mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"
                />
              </svg>
              Save Grades
            </button>
            <span class="absolute -top-2 -right-2 bg-yellow-500 text-white text-xs font-bold px-2 py-0.5 rounded-full group-hover:animate-bounce">New</span>
          </div>
          
          <button
            onclick="showGradeChart()"
            class="inline-flex items-center px-4 py-2 bg-indigo-100 dark:bg-indigo-900/50 hover:bg-indigo-200 dark:hover:bg-indigo-800/70 text-indigo-700 dark:text-indigo-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105"
          >
            <svg
              class="h-4 w-4 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
              />
            </svg>
            View Chart
          </button>
        </div>
      </div>

      <div class="overflow-x-auto">
        <table
          class="min-w-full divide-y divide-gray-200/50 dark:divide-gray-700/50"
        >
          <thead class="bg-gray-50/50 dark:bg-gray-800/50">
            <tr>
              <th
                class="px-6 py-4 text-left text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Subject
              </th>
              <th
                class="px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Term 1
              </th>
              <th
                class="px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Term 2
              </th>
              <th
                class="px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Term 3
              </th>
              <th
                class="px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Average
              </th>
              <th
                class="px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Grade
              </th>
              <th
                class="px-6 py-4 text-center text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider"
              >
                Progress
              </th>
            </tr>
          </thead>
          <tbody
            class="bg-white/30 dark:bg-gray-900/30 divide-y divide-gray-200/50 dark:divide-gray-700/50"
          >
            {% for subject in student.subjects %}
            <tr
              class="hover:bg-gray-50/50 dark:hover:bg-gray-800/50 transition-all duration-200"
            >
              <td class="px-6 py-4 whitespace-nowrap">
                <div class="flex items-center space-x-3">
                  <div
                    class="p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg"
                  >
                    <svg
                      class="h-4 w-4 text-purple-600 dark:text-purple-400"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
                      />
                    </svg>
                  </div>
                  <div>
                    <div
                      class="text-sm font-medium text-gray-900 dark:text-white"
                    >
                      {{ subject.name }}
                    </div>
                    <div class="text-xs text-gray-500 dark:text-gray-400">
                      {{ subject.code }}
                    </div>
                  </div>
                </div>
              </td>
              <td class="px-6 py-4 text-center">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value="85"
                  class="w-20 px-3 py-2 bg-gray-50/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-600 rounded-lg text-center text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"
                  data-subject="{{ subject.id }}"
                  data-term="1"
                />
              </td>
              <td class="px-6 py-4 text-center">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value="78"
                  class="w-20 px-3 py-2 bg-gray-50/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-600 rounded-lg text-center text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"
                  data-subject="{{ subject.id }}"
                  data-term="2"
                />
              </td>
              <td class="px-6 py-4 text-center">
                <input
                  type="number"
                  min="0"
                  max="100"
                  value="92"
                  class="w-20 px-3 py-2 bg-gray-50/50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-600 rounded-lg text-center text-gray-900 dark:text-white focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200"
                  data-subject="{{ subject.id }}"
                  data-term="3"
                />
              </td>
              <td class="px-6 py-4 text-center">
                <span
                  class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-emerald-100 dark:bg-emerald-900/50 text-emerald-800 dark:text-emerald-200"
                >
                  85
                </span>
              </td>
              <td class="px-6 py-4 text-center">
                <span
                  class="inline-flex items-center px-3 py-1 rounded-full text-sm font-bold bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200"
                >
                  B+
                </span>
              </td>
              <td class="px-6 py-4 text-center">
                <div class="flex items-center justify-center">
                  <div class="w-24 h-2 bg-gray-200 rounded-full dark:bg-gray-700">
                    <div class="h-2 bg-green-500 rounded-full" style="width: 85%"></div>
                  </div>
                  <span class="ml-2 text-xs text-gray-500 dark:text-gray-400">+5%</span>
                </div>
              </td>
            </tr>
            {% else %}
            <tr>
              <td colspan="7" class="px-6 py-12 text-center">
                <div class="p-6 bg-gray-50/50 dark:bg-gray-800/50 rounded-xl">
                  <svg
                    class="h-12 w-12 text-gray-400 mx-auto mb-3"
                    fill="none"
                    viewBox="0 0 24 24"
                    stroke="currentColor"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"
                    />
                  </svg>
                  <h4
                    class="text-lg font-semibold text-gray-900 dark:text-white mb-2"
                  >
                    No Academic Records
                  </h4>
                  <p class="text-gray-500 dark:text-gray-400">
                    No subjects have been assigned to this student yet.
                  </p>
                  <button
                    onclick="assignSubjects()"
                    class="mt-4 inline-flex items-center px-4 py-2 bg-purple-100 dark:bg-purple-900/50 hover:bg-purple-200 dark:hover:bg-purple-800/70 text-purple-700 dark:text-purple-300 font-semibold rounded-lg transition-all duration-200"
                  >
                    <svg
                      class="h-4 w-4 mr-2"
                      fill="none"
                      viewBox="0 0 24 24"
                      stroke="currentColor"
                    >
                      <path
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        stroke-width="2"
                        d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                      />
                    </svg>
                    Assign Subjects
                  </button>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <!-- Health & Wellness Section -->
  <div
    class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-red-100/30 dark:hover:shadow-red-900/10"
  >
    <div class="p-8">
      <div class="flex items-center justify-between mb-6">
        <div class="flex items-center">
          <div
            class="p-3 bg-gradient-to-br from-red-500 to-pink-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-2xl font-bold text-gray-900 dark:text-white">
              Health & Wellness
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Medical records and health information
            </p>
          </div>
        </div>

        <div class="flex space-x-3">
          <button
            onclick="addMedicalRecord()"
            class="inline-flex items-center px-4 py-2 bg-red-100 dark:bg-red-900/50 hover:bg-red-200 dark:hover:bg-red-900/70 text-red-700 dark:text-red-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105"
          >
            <svg
              class="h-4 w-4 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 6v6m0 0v6m0-6h6m-6 0H6"
              />
            </svg>
            Add Record
          </button>
          
          <button
            onclick="showImmunization()"
            class="inline-flex items-center px-4 py-2 bg-blue-100 dark:bg-blue-900/50 hover:bg-blue-200 dark:hover:bg-blue-800/70 text-blue-700 dark:text-blue-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105"
          >
            <svg
              class="h-4 w-4 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"
              />
            </svg>
            Immunization
          </button>
        </div>
      </div>

      {% if student.medical_records %}
      <div
        class="bg-red-50/50 dark:bg-red-900/20 rounded-xl border border-red-200/50 dark:border-red-700/50 p-6"
      >
        <div class="prose max-w-none dark:prose-invert">
          <div class="text-gray-800 dark:text-gray-200">
            {{ student.medical_records|safe }}
          </div>
        </div>
      </div>
      {% else %}
      <div class="text-center py-12">
        <div class="p-6 bg-gray-50/50 dark:bg-gray-800/50 rounded-xl">
          <svg
            class="h-16 w-16 text-gray-400 mx-auto mb-4"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"
            />
          </svg>
          <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
            No Medical Records
          </h4>
          <p class="text-gray-500 dark:text-gray-400 mb-4">
            Add medical information for this student to track health conditions
            and requirements.
          </p>
          <button
            onclick="addMedicalRecord()"
            class="inline-flex items-center px-4 py-2 bg-red-100 dark:bg-red-900/50 hover:bg-red-200 dark:hover:bg-red-900/70 text-red-700 dark:text-red-300 font-semibold rounded-lg transition-all duration-200"
          >
            <svg
              class="h-4 w-4 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 6v6m0 0v6m0-6h6m-6 0H6"
              />
            </svg>
            Add Medical Record
          </button>
        </div>
      </div>
      {% endif %}
      
      <!-- Health Metrics -->
      <div class="mt-8 grid grid-cols-1 md:grid-cols-3 gap-6">
        <!-- Height -->
        <div class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-6 hover:shadow-lg transition-all duration-300">
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-medium text-gray-900 dark:text-white">Height</h4>
            <div class="p-2 bg-green-100 dark:bg-green-900/50 rounded-lg">
              <svg class="h-5 w-5 text-green-600 dark:text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11l5-5m0 0l5 5m-5-5v12"></path>
              </svg>
            </div>
          </div>
          <div class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
            {% if student.height %} {{ student.height }} cm {% else %} -- {% endif %}
          </div>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            {% if student.height and student.height > 150 %}
            <span class="text-green-500">Above average</span> for age
            {% elif student.height %}
            <span class="text-yellow-500">Average</span> for age
            {% else %}
            Not recorded
            {% endif %}
          </div>
        </div>
        
        <!-- Weight -->
        <div class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-6 hover:shadow-lg transition-all duration-300">
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-medium text-gray-900 dark:text-white">Weight</h4>
            <div class="p-2 bg-blue-100 dark:bg-blue-900/50 rounded-lg">
              <svg class="h-5 w-5 text-blue-600 dark:text-blue-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"></path>
              </svg>
            </div>
          </div>
          <div class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
            {% if student.weight %} {{ student.weight }} kg {% else %} -- {% endif %}
          </div>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            {% if student.weight and student.weight > 40 %}
            <span class="text-green-500">Healthy</span> weight
            {% elif student.weight %}
            <span class="text-yellow-500">Monitor</span> weight
            {% else %}
            Not recorded
            {% endif %}
          </div>
        </div>
        
        <!-- BMI -->
        <div class="bg-white/70 dark:bg-gray-800/70 rounded-xl p-6 hover:shadow-lg transition-all duration-300">
          <div class="flex items-center justify-between mb-3">
            <h4 class="font-medium text-gray-900 dark:text-white">BMI</h4>
            <div class="p-2 bg-purple-100 dark:bg-purple-900/50 rounded-lg">
              <svg class="h-5 w-5 text-purple-600 dark:text-purple-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
              </svg>
            </div>
          </div>
          <div class="text-3xl font-bold text-gray-900 dark:text-white mb-2">
            {% if student.height and student.weight %} 
              {{ ((student.weight / ((student.height/100) ** 2))|round(1)) }}
            {% else %} -- {% endif %}
          </div>
          <div class="text-sm text-gray-500 dark:text-gray-400">
            {% if student.height and student.weight %}
              {% set bmi = (student.weight / ((student.height/100) ** 2)) %}
              {% if bmi > 25 %}
                <span class="text-red-500">Overweight</span>
              {% elif bmi < 18.5 %}
                <span class="text-yellow-500">Underweight</span>
              {% else %}
                <span class="text-green-500">Normal</span>
              {% endif %}
            {% else %}
              Not calculated
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Student Identification Section -->
  <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
    <!-- QR Code Section -->
    <div
      class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-indigo-100/30 dark:hover:shadow-indigo-900/10"
    >
      <div class="p-8">
        <div class="flex items-center mb-6">
          <div
            class="p-3 bg-gradient-to-br from-indigo-500 to-blue-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h2M4 4h5.01M4 20h5.01"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">
              Student QR Code
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              For attendance scanning and identification
            </p>
          </div>
        </div>

        <div class="text-center">
          {% if student.qr_path %}
          <div
            class="inline-block p-6 bg-white dark:bg-gray-800 rounded-2xl shadow-lg transform hover:scale-105 transition-transform duration-300"
          >
            <img
              src="{{ url_for('static', filename='qr_storage/' + student.qr_path) }}"
              alt="Student QR Code"
              class="w-48 h-48 mx-auto rounded-xl"
            />
          </div>
          <div class="mt-4">
            <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">
              Scan this code for attendance and identification
            </p>
            <div class="flex justify-center space-x-3">
              <button
                onclick="downloadQR()"
                class="inline-flex items-center px-4 py-2 bg-indigo-100 dark:bg-indigo-900/50 hover:bg-indigo-200 dark:hover:bg-indigo-800/70 text-indigo-700 dark:text-indigo-300 rounded-lg transition-all duration-200 hover:scale-105"
              >
                <svg
                  class="h-4 w-4 mr-2"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
                  />
                </svg>
                Download QR
              </button>
              <button
                onclick="printQR()"
                class="inline-flex items-center px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-all duration-200 hover:scale-105"
              >
                <svg
                  class="h-4 w-4 mr-2"
                  fill="none"
                  viewBox="0 0 24 24"
                  stroke="currentColor"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"
                  />
                </svg>
                Print QR
              </button>
            </div>
          </div>
          {% else %}
          <div class="p-12 bg-gray-50/50 dark:bg-gray-800/50 rounded-2xl">
            <svg
              class="h-16 w-16 text-gray-400 mx-auto mb-4"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h2M4 4h5.01M4 20h5.01"
              />
            </svg>
            <p class="text-gray-500 dark:text-gray-400 font-medium">
              QR Code Not Generated
            </p>
            <p class="text-sm text-gray-400 dark:text-gray-500 mt-1">
              Contact administrator to generate QR code
            </p>
            <button
              onclick="generateQR()"
              class="mt-4 inline-flex items-center px-4 py-2 bg-indigo-100 dark:bg-indigo-900/50 hover:bg-indigo-200 dark:hover:bg-indigo-800/70 text-indigo-700 dark:text-indigo-300 font-semibold rounded-lg transition-all duration-200"
            >
              <svg
                class="h-4 w-4 mr-2"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M12 4v1m6 11h2m-6 0h-2v4m0-11v3m0 0h.01M12 12h4.01M16 20h4M4 12h4m12 0h2M4 4h5.01M4 20h5.01"
                />
              </svg>
              Generate QR Code
            </button>
          </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div
      class="bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg rounded-2xl border border-gray-200/70 dark:border-gray-700/50 shadow-xl shadow-gray-300/20 dark:shadow-gray-900/20 overflow-hidden transition-all duration-500 hover:shadow-lg hover:shadow-emerald-100/30 dark:hover:shadow-emerald-900/10"
    >
      <div class="p-8">
        <div class="flex items-center mb-6">
          <div
            class="p-3 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl shadow-lg mr-4 transform hover:rotate-6 transition-transform duration-300"
          >
            <svg
              class="h-6 w-6 text-white"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M13 10V3L4 14h7v7l9-11h-7z"
              />
            </svg>
          </div>
          <div>
            <h3 class="text-xl font-bold text-gray-900 dark:text-white">
              Quick Actions
            </h3>
            <p class="text-sm text-gray-500 dark:text-gray-400">
              Manage student information
            </p>
          </div>
        </div>

        <div class="space-y-4">
          <a
            href="{{ url_for('students.edit', student_id=student.id) }}"
            class="w-full inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white font-semibold rounded-xl shadow-lg hover:shadow-xl transform hover:scale-105 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
              />
            </svg>
            Edit Student Information
          </a>

          <button
            onclick="generateReport()"
            class="w-full inline-flex items-center justify-center px-6 py-3 bg-emerald-100 dark:bg-emerald-900/50 hover:bg-emerald-200 dark:hover:bg-emerald-800/70 text-emerald-700 dark:text-emerald-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:ring-offset-2"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
              />
            </svg>
            Generate Report
          </button>

          <button
            onclick="printProfile()"
            class="w-full inline-flex items-center justify-center px-6 py-3 bg-amber-100 dark:bg-amber-900/50 hover:bg-amber-200 dark:hover:bg-amber-800/70 text-amber-700 dark:text-amber-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-amber-500 focus:ring-offset-2"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"
              />
            </svg>
            Print Student Profile
          </button>

          {% if student.classroom %}
          <a
            href="{{ url_for('attendance.manual_attendance', class_id=student.classroom.id) }}"
            class="w-full inline-flex items-center justify-center px-6 py-3 bg-purple-100 dark:bg-purple-900/50 hover:bg-purple-200 dark:hover:bg-purple-800/70 text-purple-700 dark:text-purple-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"
              />
            </svg>
            Mark Attendance
          </a>
          {% endif %}

          <a
            href="{{ url_for('students.index') }}"
            class="w-full inline-flex items-center justify-center px-6 py-3 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 font-semibold rounded-xl transition-all duration-200 hover:scale-105 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2"
          >
            <svg
              class="h-5 w-5 mr-2"
              fill="none"
              viewBox="0 0 24 24"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M10 19l-7-7m0 0l7-7m-7 7h18"
              />
            </svg>
            Back to Student List
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Floating Action Button -->
<div class="fixed bottom-8 right-8 z-50">
  <div class="relative group">
    <button
      onclick="showQuickActions()"
      class="p-4 bg-gradient-to-br from-indigo-600 to-purple-600 text-white rounded-full shadow-xl hover:shadow-2xl transform hover:scale-110 transition-all duration-200 focus:outline-none"
    >
      <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
      </svg>
    </button>
    
    <!-- Quick Actions Menu -->
    <div class="absolute bottom-16 right-0 hidden group-hover:block w-48 bg-white dark:bg-gray-800 rounded-lg shadow-xl p-2 space-y-2">
      <a href="#" class="flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
        </svg>
        Edit Profile
      </a>
      <a href="#" class="flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
        </svg>
        Generate Report
      </a>
      <a href="#" class="flex items-center px-3 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
        </svg>
        Print Profile
      </a>
      <div class="border-t border-gray-200 dark:border-gray-700 my-1"></div>
      <a href="#" class="flex items-center px-3 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg">
        <svg class="h-4 w-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
        </svg>
        Delete Student
      </a>
    </div>
  </div>
</div>

<!-- Modal for Medical Details -->
<div id="medicalModal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Medical Details</h3>
        <button onclick="closeModal('medicalModal')" class="text-gray-400 hover:text-gray-500">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="prose max-w-none dark:prose-invert">
        <div class="text-gray-800 dark:text-gray-200">
          {{ student.medical_records|safe }}
        </div>
      </div>
      <div class="mt-6 flex justify-end">
        <button onclick="closeModal('medicalModal')" class="px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-all duration-200">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal for Notes Details -->
<div id="notesModal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Student Notes</h3>
        <button onclick="closeModal('notesModal')" class="text-gray-400 hover:text-gray-500">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="prose max-w-none dark:prose-invert">
        <div class="text-gray-800 dark:text-gray-200">
          {{ student.notes|safe }}
        </div>
      </div>
      <div class="mt-6 flex justify-end">
        <button onclick="closeModal('notesModal')" class="px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-all duration-200">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Modal for Grade Chart -->
<div id="gradeChartModal" class="fixed inset-0 z-50 flex items-center justify-center hidden bg-black bg-opacity-50">
  <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] overflow-y-auto">
    <div class="p-6">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold text-gray-900 dark:text-white">Academic Performance Chart</h3>
        <button onclick="closeModal('gradeChartModal')" class="text-gray-400 hover:text-gray-500">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="h-96">
        <!-- Chart will be rendered here -->
        <canvas id="performanceChart"></canvas>
      </div>
      <div class="mt-6 flex justify-end">
        <button onclick="closeModal('gradeChartModal')" class="px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-300 rounded-lg transition-all duration-200">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Animate sections on load with staggered delay
    const sections = document.querySelectorAll('.bg-white\\/80, .bg-gradient-to-br, .bg-gray-900\\/80');
    sections.forEach((section, index) => {
      section.style.opacity = '0';
      section.style.transform = 'translateY(20px)';
      setTimeout(() => {
        section.style.transition = 'all 0.6s cubic-bezier(0.22, 1, 0.36, 1)';
        section.style.opacity = '1';
        section.style.transform = 'translateY(0)';
      }, index * 150);
    });

    // Auto-calculate averages when grades change
    const gradeInputs = document.querySelectorAll('input[type="number"]');
    gradeInputs.forEach(input => {
      input.addEventListener('input', calculateRowAverage);
    });

    // Initialize tooltips
    const tooltips = document.querySelectorAll('.tooltip');
    tooltips.forEach(tooltip => {
      const tooltipText = tooltip.getAttribute('data-tooltip');
      const tooltipElement = document.createElement('div');
      tooltipElement.className = 'hidden absolute z-50 w-max max-w-xs px-3 py-2 text-sm text-white bg-gray-800 rounded-lg shadow-lg';
      tooltipElement.textContent = tooltipText;
      tooltip.appendChild(tooltipElement);
      
      tooltip.addEventListener('mouseenter', () => {
        tooltipElement.classList.remove('hidden');
        tooltipElement.classList.add('block');
      });
      
      tooltip.addEventListener('mouseleave', () => {
        tooltipElement.classList.remove('block');
        tooltipElement.classList.add('hidden');
      });
    });
  });

  function calculateRowAverage(event) {
    const row = event.target.closest('tr');
    if (!row) return;
    
    const inputs = row.querySelectorAll('input[type="number"]');
    const averageCell = row.querySelector('td:nth-child(5) span');
    const gradeCell = row.querySelector('td:nth-child(6) span');
    const progressBar = row.querySelector('td:nth-child(7) div div');
    const progressText = row.querySelector('td:nth-child(7) span');

    let total = 0;
    let count = 0;

    inputs.forEach(input => {
      const value = parseFloat(input.value);
      if (!isNaN(value) {
        if (value < 0) input.value = 0;
        if (value > 100) input.value = 100;
        total += parseFloat(input.value);
        count++;
      }
    });

    if (count > 0) {
      const average = Math.round(total / count);
      averageCell.textContent = average;
      
      // Update progress bar
      progressBar.style.width = `${average}%`;
      progressBar.className = `h-2 ${getProgressColor(average)} rounded-full`;
      
      // Update progress text
      const change = Math.floor(Math.random() * 10) - 2; // Random change between -2 and +7
      progressText.textContent = change >= 0 ? `+${change}%` : `${change}%`;
      progressText.className = `ml-2 text-xs ${change >= 0 ? 'text-green-500' : 'text-red-500'}`;

      // Update grade based on average
      updateGradeCell(average, gradeCell);
    }
  }

  function getProgressColor(average) {
    if (average >= 85) return 'bg-green-500';
    if (average >= 70) return 'bg-blue-500';
    if (average >= 60) return 'bg-yellow-500';
    return 'bg-red-500';
  }

  function updateGradeCell(average, gradeCell) {
    let grade = 'F';
    let gradeClass = 'bg-red-100 dark:bg-red-900/50 text-red-800 dark:text-red-200';

    if (average >= 90) {
      grade = 'A+';
      gradeClass = 'bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200';
    } else if (average >= 85) {
      grade = 'A';
      gradeClass = 'bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200';
    } else if (average >= 80) {
      grade = 'B+';
      gradeClass = 'bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200';
    } else if (average >= 75) {
      grade = 'B';
      gradeClass = 'bg-blue-100 dark:bg-blue-900/50 text-blue-800 dark:text-blue-200';
    } else if (average >= 70) {
      grade = 'C+';
      gradeClass = 'bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200';
    } else if (average >= 65) {
      grade = 'C';
      gradeClass = 'bg-yellow-100 dark:bg-yellow-900/50 text-yellow-800 dark:text-yellow-200';
    } else if (average >= 60) {
      grade = 'D';
      gradeClass = 'bg-orange-100 dark:bg-orange-900/50 text-orange-800 dark:text-orange-200';
    }

    gradeCell.textContent = grade;
    gradeCell.className = `inline-flex items-center px-3 py-1 rounded-full text-sm font-bold ${gradeClass}`;
  }

  function downloadQR() {
    {% if student.qr_path %}
    const link = document.createElement('a');
    link.href = "{{ url_for('static', filename='qr_storage/' + student.qr_path) }}";
    link.download = "{{ student.full_name }}_QR_Code.png";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    
    // Show download confirmation
    showToast('QR code downloaded successfully!', 'success');
    {% endif %}
  }

  function printQR() {
    {% if student.qr_path %}
    const printWindow = window.open('', '_blank');
    printWindow.document.write(`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Print QR Code - {{ student.full_name }}</title>
        <style>
          body { text-align: center; padding: 20px; font-family: Arial, sans-serif; }
          h1 { margin-bottom: 5px; }
          .school-name { font-size: 18px; margin-bottom: 20px; }
          .qr-container { margin: 20px auto; width: 300px; }
          .student-info { margin-top: 20px; font-size: 14px; }
        </style>
      </head>
      <body>
        <h1>{{ student.full_name }}</h1>
        <div class="school-name">Namong SDA JHS</div>
        <div class="qr-container">
          <img src="{{ url_for('static', filename='qr_storage/' + student.qr_path) }}" width="300" height="300">
        </div>
        <div class="student-info">
          <p>Student ID: {{ student.id }}</p>
          <p>Class: {{ student.classroom.name if student.classroom else 'Unassigned' }}</p>
        </div>
        <script>
          window.onload = function() { window.print(); window.close(); }
        </script>
      </body>
      </html>
    `);
    printWindow.document.close();
    {% endif %}
  }

  function printProfile() {
    // Show print preview modal before actual printing
    showToast('Preparing print preview...', 'info');
    setTimeout(() => {
      window.print();
    }, 1000);
  }

  function generateQR() {
    showToast('Requesting QR code generation...', 'info');
    // In a real implementation, this would call your backend to generate a QR code
    setTimeout(() => {
      showToast('QR code generated successfully!', 'success');
      // Reload the page to show the new QR code
      setTimeout(() => {
        window.location.reload();
      }, 1500);
    }, 2000);
  }

  function showGradeChart() {
    const modal = document.getElementById('gradeChartModal');
    modal.classList.remove('hidden');
    
    // Initialize chart
    setTimeout(() => {
      const ctx = document.getElementById('performanceChart').getContext('2d');
      
      // Sample data - in a real app this would come from your database
      const subjects = [];
      const term1Grades = [];
      const term2Grades = [];
      const term3Grades = [];
      
      document.querySelectorAll('tbody tr').forEach(row => {
        const subjectName = row.querySelector('td:first-child div div:first-child').textContent.trim();
        const term1 = parseFloat(row.querySelector('td:nth-child(2) input').value);
        const term2 = parseFloat(row.querySelector('td:nth-child(3) input').value);
        const term3 = parseFloat(row.querySelector('td:nth-child(4) input').value);
        
        subjects.push(subjectName);
        term1Grades.push(term1);
        term2Grades.push(term2);
        term3Grades.push(term3);
      });
      
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: subjects,
          datasets: [
            {
              label: 'Term 1',
              data: term1Grades,
              backgroundColor: 'rgba(99, 102, 241, 0.7)',
              borderColor: 'rgba(99, 102, 241, 1)',
              borderWidth: 1
            },
            {
              label: 'Term 2',
              data: term2Grades,
              backgroundColor: 'rgba(168, 85, 247, 0.7)',
              borderColor: 'rgba(168, 85, 247, 1)',
              borderWidth: 1
            },
            {
              label: 'Term 3',
              data: term3Grades,
              backgroundColor: 'rgba(236, 72, 153, 0.7)',
              borderColor: 'rgba(236, 72, 153, 1)',
              borderWidth: 1
            }
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              max: 100,
              ticks: {
                callback: function(value) {
                  return value + '%';
                }
              }
            }
          },
          plugins: {
            tooltip: {
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.raw + '%';
                }
              }
            }
          }
        }
      });
    }, 100);
  }

  function showMedicalDetails() {
    const modal = document.getElementById('medicalModal');
    modal.classList.remove('hidden');
  }

  function showNotesDetails() {
    const modal = document.getElementById('notesModal');
    modal.classList.remove('hidden');
  }

  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    modal.classList.add('hidden');
  }

  function generateReport() {
    const reportBtn = event.target;
    const originalText = reportBtn.innerHTML;

    reportBtn.innerHTML = `
      <svg class="h-5 w-5 mr-2 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
      Generating Report...
    `;
    reportBtn.disabled = true;

    // Simulate report generation
    setTimeout(() => {
      reportBtn.innerHTML = originalText;
      reportBtn.disabled = false;
      
      // Show success message
      showToast('Report generated successfully!', 'success');
      
      // In a real implementation, this would download the generated report
      const link = document.createElement('a');
      link.href = '#';
      link.download = '{{ student.full_name }}_Academic_Report.pdf';
      link.click();
    }, 2000);
  }

  function saveGrades() {
    const saveBtn = event.target;
    const originalText = saveBtn.innerHTML;

    saveBtn.innerHTML = `
      <svg class="h-4 w-4 mr-2 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
      </svg>
      Saving...
    `;
    saveBtn.disabled = true;

    // Collect all grade data
    const gradeData = {};
    const gradeInputs = document.querySelectorAll('input[type="number"]');

    gradeInputs.forEach(input => {
      const subjectId = input.dataset.subject;
      const term = input.dataset.term;
      const value = input.value;

      if (!gradeData[subjectId]) {
        gradeData[subjectId] = {};
      }
      gradeData[subjectId][`term${term}`] = value;
    });

    // Simulate save process
    setTimeout(() => {
      saveBtn.innerHTML = originalText;
      saveBtn.disabled = false;
      
      // Show success message
      showToast('Grades saved successfully!', 'success');
      
      // Here you would typically send the data to the server
      console.log('Grade data to save:', gradeData);
    }, 1500);
  }

  function addMedicalRecord() {
    // This would typically open a modal or redirect to a form
    showToast('Opening medical record form...', 'info');
    console.log('Add medical record functionality would be implemented here');
  }

  function showImmunization() {
    showToast('Showing immunization records...', 'info');
    console.log('Immunization records would be shown here');
  }

  function assignSubjects() {
    showToast('Redirecting to subject assignment...', 'info');
    console.log('Subject assignment functionality would be implemented here');
  }

  function toggleStatus() {
    const statusBadge = event.currentTarget;
    const isActive = statusBadge.classList.contains('bg-green-500');
    
    if (isActive) {
      statusBadge.classList.remove('bg-green-500');
      statusBadge.classList.add('bg-yellow-500');
      statusBadge.innerHTML = `
        <svg class="h-4 w-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
        </svg>
      `;
      showToast('Student status changed to Inactive', 'warning');
    } else {
      statusBadge.classList.remove('bg-yellow-500');
      statusBadge.classList.add('bg-green-500');
      statusBadge.innerHTML = `
        <svg class="h-4 w-4 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      `;
      showToast('Student status changed to Active', 'success');
    }
  }

  function callNumber(number) {
    showToast(`Calling ${number}...`, 'info');
    console.log(`In a real app, this would call ${number}`);
  }

  function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
      showToast('Copied to clipboard!', 'success');
    }).catch(err => {
      showToast('Failed to copy text', 'error');
      console.error('Failed to copy text: ', err);
    });
  }

  function showQuickActions() {
    // This is handled by the hover effect on the FAB
  }

  function showToast(message, type) {
    const toast = document.createElement('div');
    toast.className = `fixed top-4 right-4 px-6 py-3 rounded-lg shadow-lg z-50 flex items-center transition-all duration-300 transform translate-x-64`;
    
    // Set styles based on type
    if (type === 'success') {
      toast.className += ' bg-green-500 text-white';
    } else if (type === 'error') {
      toast.className += ' bg-red-500 text-white';
    } else if (type === 'warning') {
      toast.className += ' bg-yellow-500 text-white';
    } else {
      toast.className += ' bg-blue-500 text-white';
    }
    
    // Add icon based on type
    let iconPath = '';
    if (type === 'success') {
      iconPath = 'M5 13l4 4L19 7';
    } else if (type === 'error') {
      iconPath = 'M6 18L18 6M6 6l12 12';
    } else if (type === 'warning') {
      iconPath = 'M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z';
    } else {
      iconPath = 'M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z';
    }
    
    toast.innerHTML = `
      <svg class="h-6 w-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${iconPath}" />
      </svg>
      ${message}
    `;
    
    document.body.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
      toast.classList.remove('translate-x-64');
      toast.classList.add('translate-x-0');
    }, 10);
    
    // Auto-dismiss after 3 seconds
    setTimeout(() => {
      toast.classList.add('opacity-0', 'translate-x-64');
      setTimeout(() => {
        document.body.removeChild(toast);
      }, 300);
    }, 3000);
  }
</script>

<style>
  @keyframes gradient-x {
    0% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
    100% { background-position: 0% 50%; }
  }
  
  .animate-gradient-x {
    background-size: 200% 200%;
    animation: gradient-x 6s ease infinite;
  }
  
  @media print {
    .no-print {
      display: none !important;
    }
    
    body {
      background: white !important;
      font-size: 12pt;
    }
    
    .bg-white\/80,
    .bg-gray-900\/80 {
      background: white !important;
      border: 1px solid #e5e7eb !important;
    }
    
    .shadow-xl, .shadow-lg {
      box-shadow: none !important;
    }
    
    .fixed {
      display: none !important;
    }
  }
</style>

{% endblock %}